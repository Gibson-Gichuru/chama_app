# api test run workflow

name: Application Testing Workflow

on:

  push:

    branches:

      - development

  pull_request:

    branches:

      - development

jobs:

  testingApi:

    runs-on: ubuntu-latest

    env: 

      MARIADB_ROOT_PASSWORD: ${{ secrets.DATABASE_ROOT_PASSWORD }}      

    steps:

      - name: Checking out the repository
        uses: actions/checkout@v2

      - name: Building the application test network

        run: docker network create test-net

      - name: Building the application image

        run: docker build $(pwd)/api -t test_app -f $(pwd)/api/Dockerfile

      - name : Adding the application container to the test-net network


        run: docker run -itd --name api-test --network test-net test_app

      - name: setting up the redis container on the test-net network

        run: docker run -itd --name redis --network test-net redis

      - name: Running the Api unit tests

        run: | 

          export FLASK_APP=manage.py

          docker exec -i api-test flask test 

  testingFrontEnd:

    runs-on: ubuntu-latest

    steps:

      - name: Checking out the repository
      
        uses: actions/checkout@v2

      - name: Setting up node js

        run: echo "Nodejs will be set up Sooon!!"
